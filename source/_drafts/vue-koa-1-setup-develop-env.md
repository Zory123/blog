---
title: 使用 Vue + Koa 打造全栈应用 x -- 部署篇
date: 2018-03-24 22:17:56
categories: 心得
tags:
  - Vue
  - Koa
  - PM2
---

# 前言

之前在学校用前端 pjax 无刷新跳转 + 后端 php 服务端渲染做了一个应用, 用来做校内的图片分享网站, 后来离校后就没怎么管了, 所以只做了一点就弃坑了. 

最近又想起来那个项目, 所以这次抱着学习的心态使用 vue + koa 来重新将这个项目拾起来, 一方面可以学习一些当下的新框架了解前段发展趋势, 另一方面也可以充实下自己的简历.

## PM2

使用 PM2 作为 nodejs 的守护进程, 这样在服务宕掉后可以自动重启服务, 也可以设置开机自启动.

### 日志

如果不做设置, 那么在 PM2 中纪录的日志是没有时间戳的.  
如果需要时间戳, 可按以下命令重启服务, `--log-date-format` 后跟的参数可使用 `momentjs` 支持的时间格式

``` bash
pm2 restart webhooks --log-date-format '\[YYYY-MM-DD HH:mm:ss\]'
```

然后打印出的日志就像下面这样了

``` log
[2018-03-25 02:14:07]: deploy server on listen in 3000...
```


## Nginx

### 开启压缩

### 反向代理
